{% extends "layout.html" %}

{% block content %}
    <header>
        <div class="header-links">
            <a href="{{ url_for('skills.create_post')}}" class="btn btn-primary">Create Post</a>
        </div>    
    </header>

    <h1>Create Post</h1>
    <form method="post">
        <label for="title">Title:</label><br>
        <input type="text" id="title" name="title" required><br><br>
        
        <label for="content">Content:</label><br>
        <textarea id="content" name="content" required></textarea><br><br>
        
        <label for="url">URL (optional):</label><br>
        <input type="text" id="url" name="url"><br><br>
        
        <button type="submit" class="btn btn-primary">Create Post</button>
    </form>

    <hr>
    <h2>View Posts</h2>
    <ul>
        {% for post in posts %}
            <li>
                <h3>{{ post.title }}</h3>
                <p>{{ post.content }}</p>
                {% if post.url %}
                    <p>URL: {{ post.url }}</p>
                {% endif %}
                <a href="{{ url_for('skills.view_post', post_id=post.id) }}" class="btn btn-primary">View Comments</a>
                <form action="{{ url_for('skills.delete_post', post_id=post.id) }}" method="post">
                    <button type="submit" class="btn btn-danger">Delete Post</button>
                </form>
                <hr>

                <!-- Comments -->
                <form method="post" action="{{ url_for('skills.add_comment', post_id=post.id) }}">
                    <label for="comment_content">Add Comment:</label><br>
                    <textarea id="comment_content" name="comment_content" required></textarea><br>
                    <button type="submit" class="btn btn-primary">Add Comment</button>
                </form>

                <!-- Display Comments -->
                <ul>
                    {% for comment in post.comments %}
                        <li>
                            <p>{{ comment.content }}</p>
                            <p> By: {{ comment.author }}</p>
                            <form action="{{ url_for('skills.delete_comment', post_id=post.id, comment_id=comment.id) }}" method="post">
                                <button type="submit" class="btn btn-danger">Delete</button>
                            </form>
                        </li>
                    {% endfor %}
                </ul>
            </li>
        {% endfor %}
    </ul>
{% endblock %}
